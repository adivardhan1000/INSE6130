#!/usr/bin/env python3

import subprocess

try:
	# Get runc version
	cmd = "dpkg -l runc | grep -E '^ii\s+runc\s+'"
	runc_version = subprocess.check_output(cmd, shell=True).decode().split()[2].split("+")[0].split("~")
	print(runc_version)
	#runc_version = runc_version.split("-")[0]
	# Check if runc version is vulnerable
	if runc_version[0] == '1.0.0' and runc_version[1] <= 'rc95':
		print(f"Your version of runc ({runc_version}) is vulnerable.")
		if input("Do you want to upgrade to fix?(y/n)").strip().lower() == "y":
			# Upgrade runc to the latest version
			cmd = "sudo apt-get update && sudo apt-get install -y runc"
			subprocess.run(cmd, shell=True)
			print("runc upgraded to the latest version.")
	else:
		print(f"Your version of runc is not vulnerable.")

except subprocess.CalledProcessError as e:
	print("runc is not installed.")
    # Handle non-zero exit status
	print("Error: ", e.output.decode())
